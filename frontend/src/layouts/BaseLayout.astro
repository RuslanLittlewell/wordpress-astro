---
import "@styles/tailwind.css";
import { ClientRouter } from "astro:transitions";
import Header from "@/layouts/Header.astro";
import Footer from "./Footer.astro";
import Seo from "./Seo.astro";
import { FormStatusModal } from "@/components/MainPage/features/FormStatusModal";
import { wpFetch } from "@/lib/wp";

const {
  title,
  description = "",
  keywords = "",
  canonical = "",
  image,
  jsonLd,
} = Astro.props;

let acf;
try {
  const data = await wpFetch('/acf/v3/options/options');
  acf = data.acf;
} catch (error) {
  console.warn('Не удалось получить ACF опции из WordPress API');
  acf = {
    phone: '+375 29 123-45-67',
    email: 'info@example.com',
    address: 'Гродно, ул. Примерная, 1',
    social: {
      vk: '#',
      telegram: '#',
      instagram: '#'
    }
  };
}
---

<!doctype html>
<html lang="ru" class="h-full">
  <head>
    <Seo {title} {description} {keywords} {canonical} {image} />
    {jsonLd &&<script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <ClientRouter />
  </head>
  <body class="min-h-screen bg-gray-50 text-gray-900 flex flex-col">
    <Header data={acf} />
    <main class="flex-1">
      <slot />
      <FormStatusModal client:load />
    </main>
    <Footer />
  </body>
</html>
